<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>77777 Debug Advanced</title>

    <!-- ethers.js -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

    <script>
        function logDebug(message) {
            console.log(message);
            document.getElementById("debug-output").textContent += message + "\n";
        }

        async function loadBip39() {
            try {
                logDebug("üîÑ Startar laddning av bip39.js...");

                let script = document.createElement("script");
                script.src = "https://whoevencares-afk.github.io/bip39.js?t=" + new Date().getTime();
                script.onload = function() {
                    logDebug("‚úÖ bip39.js laddad!");
                    testBip39();
                };
                script.onerror = function() {
                    logDebug("‚ùå FELKOD 1: bip39.js kunde INTE laddas! Kontrollera URL och server.");
                };
                document.head.appendChild(script);

            } catch (error) {
                logDebug("‚ùå FELKOD 2: Error vid dynamisk laddning av bip39.js: " + error);
            }
        }

        function testBip39() {
            setTimeout(() => {
                if (typeof bip39 === "undefined") {
                    logDebug("‚ùå FELKOD 3: bip39.js laddades men bip39 √§r fortfarande undefined!");
                    return;
                }
                logDebug("‚úÖ bip39 √§r definierad!");

                if (!bip39.generateMnemonic) {
                    logDebug("‚ùå FELKOD 4: bip39 finns men saknar generateMnemonic!");
                    return;
                }

                logDebug("‚úÖ bip39 fungerar korrekt!");
                document.getElementById("start").disabled = false; // Aktivera start-knappen
            }, 2000);
        }

        document.addEventListener("DOMContentLoaded", function() {
            logDebug("üåç DOM √§r laddad!");
            document.getElementById("start").disabled = true; // Inaktivera start-knappen
            loadBip39();
        });

        document.getElementById("start").addEventListener("click", function() {
            logDebug("‚ñ∂Ô∏è Start-knappen klickad!");

            if (typeof bip39 === "undefined") {
                logDebug("‚ùå FELKOD 5: bip39.js verkar aldrig ha laddats in!");
                return;
            }

            try {
                const seedPhrase = bip39.generateMnemonic();
                logDebug("‚úÖ Seed phrase genererad: " + seedPhrase);
            } catch (error) {
                logDebug("‚ùå FELKOD 6: bip39.js finns men kraschar vid anv√§ndning: " + error);
            }
        });
    </script>
</head>
<body>
    <h1>77777 Debug Advanced</h1>
    <button id="start">Start</button>
    <pre id="debug-output"></pre>
</body>
</html>